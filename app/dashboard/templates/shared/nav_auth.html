{% comment %}
  Copyright (C) 2020 Gitcoin Core

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published
  by the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program. If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}
{% load i18n static %}
{% load kudos_extras %}
<input id="is-authenticated" type="hidden" value={{ user.is_authenticated }}>

{% if show_sales_action %}
  <a class="btn button--primary shadow-none py-2 px-4 text-white font-weight-semibold mr-md-3 my-3 my-md-0" target="_blank" href="https://hackathons.gitcoin.co/contact/">Contact Sales</a>
{% endif %}
{% if user.is_authenticated %}
  <div class="nav-item dropdown interior">

    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownWallet" role="button"
      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <b class="wallet-network">â€¢</b><i class="fas fa-wallet provider-icon"></i>
    </a>
    <div class="dropdown-menu dropdown-menu-right shadow-lg" aria-labelledby="navbarDropdownWallet">
      <a class="dropdown-item" href="#" id="wallet-btn">
        Connect Wallet
      </a>
      <div class="dropdown-item wallet-hidden d-none">
        <small>connected to:</small>
        <div class="network-name"></div>
        <div class="selected-account" data-toggle="tooltip" title="Click to copy"></div>
      </div>
      <div class="dropdown-divider wallet-hidden d-none"></div>
      <div id="wallet-accounts" class="dropdown-item wallet-hidden d-none"></div>
      <div class="dropdown-divider wallet-hidden d-none"></div>
      <a href="#" class="dropdown-item wallet-hidden d-none" id="btn-disconnect">
        Disconnect
      </a>
    </div>

  </div>
  <div id="templates" style="display: none">
    <template id="template-balance">
      <div class="wallet-option" data-toggle="tooltip" title="Click to select this wallet">
      	<div class="wallet-address"></div>
      	<small class="wallet-balance"></small>
      </div>
    </template>
  </div>

  <div class="nav-item dropdown interior">
    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      {{ user }}
    </a>
    <div class="dropdown-menu dropdown-menu-right shadow-lg" aria-labelledby="navbarDropdown">
      {% if source == 'authed' %}
        <a class="dropdown-item" href="{% url "dashboard" %}">
          <i class="fas fa-tachometer-alt"></i>
          {% trans "Dashboard" %}
        </a>
        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="{% url "new_funding" %}">
          <i class="fab fa-ethereum"></i>
          {% trans "Fund Issue" %}
        </a>
        <a class="dropdown-item" href="{% url "tip" %}">
          <i class="far fa-paper-plane"></i>
          {% trans "Send Tip" %}
        </a>
        <a class="dropdown-item" href="{% url "kudos_marketplace" %}">
          <i class="fas"><img src="{% static "v2/images/kudos/IconKudos.svg" %}"></i>
          {% trans "Send Kudos" %}
        </a>
        <a class="dropdown-item" href="/grants/new">
        <i class="fas fa-money-check-alt"></i>
          {% trans "Create Grant" %}
        </a>
        <div class="dropdown-divider"></div>
        <a class="dropdown-item" data-gtm="profile" href="{{profile_url}}">
          <i class="fas fa-user"></i>
          {% trans "My Profile" %}
        </a>
        <a class="dropdown-item" href="/wiki">
          <i class="fas fa-question-circle"></i>
          {% trans "Wiki" %}
        </a>
      {% else %}
        <a class="dropdown-item" data-gtm="get started" href="{% url "get_gitcoin" %}">
          <i class="fas fa-bolt"></i>
          {% trans "Get Started" %}
        </a>
      {% endif %}

      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="{% url "email_settings" email_key %}">
        <i class="fas fa-cog"></i>
        {% trans "Manage Settings" %}
      </a>
      {% if unclaimed_tips %}
        <div class="dropdown-divider"></div>
        {% for tip in unclaimed_tips %}
          <a class="dropdown-item" href="{{ tip.receive_url }}">
            <i class="fas fa-dollar-sign"></i>
            {% trans "Claim" %} ${{ tip.value_in_usdt_now }} {% trans "Tip" %}
          </a>
        {% endfor %}
      {% endif %}
      {% if unclaimed_kudos %}
        <div class="dropdown-divider"></div>
        {% for kudos in unclaimed_kudos %}
          <a class="dropdown-item" href="{{ kudos.receive_url }}">
            <i class="fas fa-gift"></i>
            {% trans "Claim Kudos" %}
          </a>
        {% endfor %}
      {% endif %}
      {% if user.is_staff %}
        <a class="dropdown-item" href="{% url "admin:index" %}">
          <i class="fas fa-user-secret"></i>
          {% trans "Administration" %}
        </a>
      {% endif %}
      <div class="dropdown-divider"></div>
      {% if is_townsquare %}
        {% include 'shared/theme_switcher.html' with source='authed' %}
      {% endif %}
      <a class="dropdown-item" data-gtm="logout" href="{% url "logout" %}?next={{ request.get_full_path }}">
        <i class="fas fa-lock"></i>
        {% trans "Log Out" %}
      </a>
    </div>
  </div>
  <a href="/profile/" id="nav_auth_profile" class="nav_avatar d-none d-md-block"
   data-gtm="profile" style="background-image: url('/dynamic/avatar/{{user.username}}')">
  </a>
  <a href="/chat">
    {% include 'profiles/presence_indicator.html' with show_even_if_offline=1  suppress_click=1 last_chat_status=last_chat_status show_even_if_no_chat_id=1 %}
  </a>
{% else %}
  <a class="nav-link login interior" href="{% url 'social:begin' 'github' %}?next={{ request.get_full_path }}" onclick="dataLayer.push({'event': 'login'});">
    <i class="fab fa-github"></i><span class="nav-link__text">{% trans "Log in" %}</span>
  </a>
{% endif %}
