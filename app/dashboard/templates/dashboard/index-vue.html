{% comment %}
    Copyright (C) 2019 Gitcoin Core

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published
    by the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program. If not, see <http://www.gnu.org/licenses/>.

{% endcomment %}
{% load i18n static %}
<!DOCTYPE html>
<html lang="en">

  <head>
    {% include 'shared/head.html' %}
    {% if use_pic_card %}
      {% include 'shared/cards_pic.html' %}
    {% else %}
      {% include 'shared/cards.html' %}
    {% endif %}
    <link rel="stylesheet" href='{% static "v2/css/dashboard-hackathon.css" %}'/>
    <link rel="stylesheet" href='{% static "v2/css/featured-bounties.css" %}'/>
    <link rel="stylesheet" href='{% static "v2/css/tag.css" %}'/>
    <link rel="stylesheet" href='{% static "v2/css/users.css" %}' />
    <link rel="stylesheet" href='{% static "v2/css/rating.css" %}' />
    <link rel="stylesheet" href='{% static "v2/css/scroll-carousel.css" %}'/>
    <link rel="stylesheet" href='{% static "v2/css/town_square.css" %}'/>
    <link rel="stylesheet" href='{% static "v2/css/activity_stream.css" %}'/>
    <link rel="stylesheet" href='{% static "v2/css/sidebar_search.css" %}'/>
    <link rel="stylesheet" href='{% static "v2/css/hackathons/explorer.css" %}'/>

    <style type="text/css">
      @media only screen and (max-width : 320px) {
        .chatWrapper {
          height: 76vh !important;
        }

        .chatWrapper iframe {
          height: 92vh !important;
        }
      }

      .show>.btn-secondary.dropdown-toggle {
        background-color: var(--gc-blue-hover) !important;
      }

      .chatWrapper iframe {
        width: 100%;
        height: 50vh;
      }

      form .col:first-child {
        border-top: none;
      }

      .card-bg {
        background-color: #0C1A27;
        padding: 1.8em;
        background-size: cover;
      }

      .card-project {
        text-align: center;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
      }

      .card-badge {
        right: 1em;
        top: 1em;
        filter: drop-shadow(0 0.3rem 0.2rem rgba(0,0,0,0.25));
        width: 4em;
      }

      .b-avatar img {
        height: 100%;
        width: 100%;
      }

      #sponsor_sidebar {
        background-color: #F9F9F9;
        height: 100%;
      }

      .card-project-logo {
        background-color: rgba(255, 255, 255, 0.30);
        object-fit: contain;
      }

      .project-grid {
        display: grid;
        grid-template-columns: repeat(1, 1fr);
        grid-gap: 5rem 3rem;
      }

      @media (min-width: 1200px) {
        .project-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (min-width: 1800px) {
        .project-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }

      .page-link-gc {
        color: #3e24fb;
      }

      .page-item.active .page-link-gc {
        background-color: #3e24fb;
        border-color: #3e24fb;
      }

      .nav-list-dashboard {
        position:absolute;
        bottom:0;
      }

      .hackathon-banner {
        background: {% firstof hackathon.background_color or 'white' %};
        color: {% firstof hackathon.text_color or 'black' %};
        height: 225px;
        {% if hackathon.banner %}
          background: url('{{MEDIA_URL}}{{hackathon.banner}}') 0 / cover;
        {% endif %}
      }

      .bounty_row img.avatar {
        max-width: 50px;
      }

      .hackathon-title {
          font-size: 1.4rem;
      }

      .hackathon-countdown {
          font-size: 1rem;
      }

      .bounty_row {
        background-color: white;
        margin-bottom: 15px;
        border-radius: 4px;
      }

      .hack-logo-wrapper {
          position: absolute;
          max-width: 240px;
          top: -200px;
          left: -32%;
      }

      .townsquare_header {
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      .hackathon-logo {
        height: 240px;
        max-height: 240px;
        width: 240px;
        max-width: 240px;
        background: {% firstof hackathon.background_color or '#090E60' %};
        border-radius: 10px;
        color: {% firstof hackathon.text_color or 'black' %};
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .hackathon-logo img {
        height: 185px;
        object-fit: contain;
      }

      .register {
        width: 100%;
      }

      .card-bg {
        background-color: #0C1A27;
        padding: 1.8em;
        background-size: cover;
      }

      .card-project {
        /* padding: 2em; */
        text-align: center;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
      }

      .card-badge {
        right: 1em;
        top: 1em;
        filter: drop-shadow(0 0.3rem 0.2rem rgba(0,0,0,0.25));
        width: 4em;
      }
      .controls .form-control, .controls .btn, .controls label {
        font-size: 0.7rem;
      }
      .looking-team {
        background-color: rgba(62, 0, 255, 0.05);
        border-radius: 8px;
        padding: 11px 15px;
      }
      .info-card-title {
        font-weight: bold;
        font-size: 12px;
        line-height: 22px;
        letter-spacing: 1px;
        color: #3E00FF;
      }
      .info-card-desc {
        font-style: italic;
        font-weight: normal;
        font-size: 12px;
        line-height: 18px;
        color: #666666;
      }

      @media(max-width: 767.98px) {
        .navbar-brand img {
          height:20px;
        }
        li.navigation > a.nav-link {
           font-size:14px;
        }
      }
      </style>
  </head>

  <body class="interior {{active}} g-font-muli">
    {% include 'shared/tag_manager_2.html' %}
    <div class="container-fluid header sticky-top dash">
      {% include 'shared/top_nav.html' with class='d-md-flex' %}
      {% include 'shared/nav_hackathons.html' %}
    </div>
    {% if is_staff %}
    <div class="alpha-warning font-caption mb-0">
      <span class="font-weight-bold">Staff only</span>
      <a style="color:white;" href="{{hackathon.admin_url}}">{% trans "Hackathon Admin" %}</a>
    </div>
    {% endif %}

    <div id="dashboard-content" class="container-fluid no-gutter" style="min-height:600px;">
        <div id="dashboard-vue-app" class="row" v-cloak>
          <div :id="hackathonObj.identifier" class="d-flex col-12 justify-content-between flex-column flex-md-row align-items-center p-3 banner hackathon-banner">
            <div class="offset-lg-2 col-lg-10 col-12 hackathon-text pl-4">
              <div class="mt-sm-5">
                <p class="hackathon-title title font-weight-bold mb-0">[[ hackathonObj.name ]]</p>
              </div>
              <p class="mb-1">
                {% if hackathon.start_date|timesince <= "1 min" %}
                  <small class="hackathon-countdown text-uppercase">Starts in {{hackathon.start_date | timeuntil}}</small>
                {% elif hackathon.end_date|timeuntil >= "1 min" %}
                  <small class="hackathon-countdown text-uppercase">Ends in {{hackathon.end_date|timeuntil}}</small>
                {% else %}
                  <small class="hackathon-countdown text-uppercase">Hackathon Over</small>
                {% endif %}
              </p>
            </div>
          </div>
          <div class="col-9 body hackathon-explorer">
            <b-tabs :value="activePanel" @input="tabChange" justified nav-class="col-12 col-md-8 offset-md-3 px-4" nav-wrapper-class="col-12 nav-tabs" align="left" content-class="col-12 px-4 mt-4 light-blue" class="row">
              <template v-slot:tabs-start>
                <div class="hack-logo-wrapper d-none d-md-block">
                  <div class="mb-1 hackathon-logo">
                    <b-img-lazy v-if="hackathonObj.logo_svg" class="d-none d-md-block mx-auto mb-1 mw-100" :src="hackathonObj.logo_svg" alt="Hackathon logo"></b-img-lazy>
                    <b-img-lazy v-else-if="hackathonObj.logo" class="d-none d-md-block mx-auto mb-1 mw-100" :src="hackathonObj.logo" alt="Hackathon logo"></b-img-lazy>
                    <small>{{ hackathon.start_date|date:"M j, Y" }} - {{ hackathon.end_date|date:"M j, Y" }}</small>
                  </div>
                </div>
              </template>
              <b-tab class="col-12" title-item-class="navigation">
                <template v-slot:title>
                  <div class="mt-4">
                    {% trans "Prizes" %}
                    <span class="nav-badge d-none d-sm-inline">({{prize_count}})</span>
                  </div>
                </template>
                <div id="prizes" class="row">
                  <div class="col-12 col-md-2 d-lg-block" style="background: #F2F6F9; margin-left:2%">

                    <div class="ml-sm-4 mr-4 mr-sm-0 invisible" id="sidebar_container">
                      <!-- <a :href="`/hackathon/${hackathonObj.slug}/onboard`" class="btn register btn-gc-blue mt-2" v-if="!is_registered">
                        Register
                      </a> -->
                      {% include 'dashboard/sidebar_search_hackathon.html' %}
                    </div>
                  </div>
                  <div class="col-12 col-md-9 p-2 ml-sm-4">
                    {% if not hackathon_not_started %}
                    <div class="px-2" id="bounties">
                      <div id="dashboard-title" class="hidden">
                        {% include 'shared/search_bar.html' %}
                      </div>
                      {% include 'dashboard/featured_bounties.html' %}
                      </div>
                      <div class="row loading justify-content-center align-items-center loading_img">
                        <img src="{% static "v2/images/loading_v2.gif" %}" alt="Loading ...">
                      </div>
                      <div class="row nonefound mx-auto" style="display:none;">
                          <h1 class="font-title font-weight-semibold">Hackathon Coming Soon!</h1>
                          <img class="my-3" src="{% static "v2/images/obiwan-bot.svg" %}" alt="Obiwan bot">

                          {% if hackathon.quest_link %}
                            <p>Explore Web3 and be prepared via sponsors Quests</p>
                            <a class="btn btn-gc-blue" href="{{hackathon.quest_link}}">Explore Quests</a>
                          {% elif hackathon.start_date|timesince <= "1 min" %}
                            <p>Explore Web3 via Gitcoin Quests to prepare</p>
                            <a class="btn btn-gc-blue" href="{% url 'quests_index' %}">Explore Quests</a>
                          {% endif %}

                          {% include 'shared/hackathon_sponsors.html' %}

                      </div>
                    {% else %}
                      <div class="text-center mx-auto">
                        <h1 class="font-title font-weight-semibold">Hackathon Coming Soon!</h1>
                        <img class="my-3" src="{% static "v2/images/obiwan-bot.svg" %}" alt="Obiwan bot">

                        {% if hackathon.quest_link %}
                          <p>Explore Web3 and be prepared via sponsors Quests</p>
                          <a class="btn btn-gc-blue" href="{{hackathon.quest_link}}">Explore Quests</a>
                        {% else %}
                          <p>Explore Web3 via Gitcoin Quests to prepare</p>
                          <a class="btn btn-gc-blue" href="{% url 'quests_index' %}">Explore Quests</a>
                        {% endif %}
                      </div>

                      {% include 'shared/hackathon_sponsors.html' %}
                    {% endif %}
                  </div>
                </div>
              </b-tab>
              <b-tab :disabled="!is_registered" class="col-12" title-item-class="navigation">
                <template v-slot:title>
                  <div class="mt-4">
                    {% trans "Townsquare" %}
                  </div>
                </template>
                <div class="ml-md-4 townsquare_header">
                  <div class="row">
                    <div class="ml-4 col-12 col-md-2 col-xl-3 d-lg-block">
                      <div class="col-12 subheading left-ribbon font-body">
                        {% trans "Hackathon Sponsors" %}
                      </div>
                      <div class="col-12 options" id="list-townsquare-orgs">
                        {% for org in orgs %}
                          <div class="">
                            <label class="filter-label townsquare-org-filter">
                              <img src="{{org.avatar_url}}" class="rounded-circle" width="24" height="24" alt="{{org.display_name}}"> {{org.display_name}}
                            </label>
                          </div>
                        {% endfor %}
                      </div>
                    </div>
                    <div class="feed_container col-12 col-lg-8">
                      <div class="feed_container_child">
                        {% csrf_token %}
                        {% include 'townsquare/shared/shareactivity.html' %}

                        <div id="activities" class="activity_stream {% if not is_search %}mt-4{% endif %}">
                          <span id=activity_subheader>
                            <img class="loading" src="/static/v2/images/loading_v2.gif" style="max-width: 200px; margin: 0px auto; display: block;">
                            <br>
                            <span>
                              {{card_desc}}
                            </span>
                          </span>
                          {% include 'shared/activity_container.html' %}
                        </div>
                      </div>
                    </div>
                    <div class="actions_container col-12 col-md-2 offset-1">
                    </div>
                  </div>
                </div>
              </b-tab>
                <b-tab class="col-12" title-item-class="navigation" lazy>
                  <template v-slot:title>
                    <div class="mt-4">
                      {% trans "Projects" %}
                      <span class="nav-badge d-none d-sm-inline">({{projects_count}})</span>
                    </div>
                  </template>
                  <project-directory inline-template>
                    <div class="ml-4">
                    <div class="sidebar-container flex-column flex-lg-row">
                      <transition name="fade">
                        <nav v-show="showFilters" class="sidebar flex-fill pr-4" role="navigation">
                          <div class="pb-4 border-bottom form-group">
                            <div class="d-flex flex-grow-1" id="search_projects">
                              <form class="form-inline my-2 flex-fill justify-content-center">
                                <div class="input-group w-100">
                                  <input class="form-control form-control-lg" v-model="searchTerm" type="search" placeholder="Search" aria-label="Search">
                                  <div class="input-group-append">
                                    <button type="submit" class="btn input-group-text btn-search" @click.prevent="searchProjects();"> <i class="fas fa-search"></i></button>
                                  </div>
                                </div>
                              </form>
                            </div>
                          </div>
                          <div class="pb-4 border-bottom form-group">
                            <div class="pb-4 border-bottom form-group">
                              <b-form-checkbox v-model="params.lfm" name="check-button" switch>
                                Looking for Members
                              </b-form-checkbox>
                            </div>
                          <div class="pb-4 border-bottom form-group">
                            <label for="project_sponsors" class="font-weight-bold">Sponsor</label>
                            <div id="project_sponsors" class="form__select2">
                              <select2 v-model.trim="params.sponsor" data-minimum-results-for-search="Infinity" class="form-control">
                                <option value="" selected="true">All</option>
                                <option v-for="option in hackathonSponsors" v-bind:value="option.org_name">
                                  [[ option.display_name ]]
                                </option>
                              </select2>
                            </div>
                          </div>
                          <div class="g-multiselect pb-4 border-bottom form-group">
                            <label for="skills" class="font-weight-bold">Member Skills</label>
                            <div class="form__select2">
                              <select2 :options="skills" v-model="params.skills" data-placeholder="e.g. HTML, CSS" data-tags="true" multiple class="form-control">
                                <option disabled value="0">Select one</option>
                              </select2>
                            </div>
                          </div>
                          <button class="btn blue font-caption px-0 btn-block font-weight-semibold" @click="params = {}; searchTerm = ''; searchProjects();">Reset Filters</button>
                          <p class="font-body mx-2 mb-2 mt-4 mx-lg-0 mt-lg-2">
                            <span class="font-weight-bold">[[ numProjects ]]</span> projects found
                          </p>
                        </nav>
                      </transition>
                      <div class="container pt-4" @scroll.passive="onScroll($event)">
                        <button v-if="!hideFilterButton" class="blue btn font-smaller-1 font-weight-bold" @click="showFilters = !showFilters">[[ showFilters ? 'Hide' : 'Show' ]] filters <i class="fas fa-filter"></i></button>
                        <div class="mt-4">
                        <div v-if="noResults" class="text-center">
                          <img src="{% static 'v2/images/shrug_bot.png' %}" alt="nothing found" width="316" height="221">
                          <p class="mt-4 font-weight-bold mb-0">No projects found</p>
                          <button class="btn blue" @click="params = {}; searchTerm = ''; searchProjects();">Reset Filters</button>
                        </div>
                        <div class="project-grid ml-2">
                          <div v-for="project in hackathonProjects" class="card card-user shadow-sm border-0" :key="project.id">
                            <div class="card card-project">
                                <img v-if="project.badge" class="position-absolute card-badge" width="50" :src="profile.badge" alt="badge" />

                                <div class="card-bg rounded-top" style="">
                                  <img v-if="project.logo" class="card-project-logo m-auto rounded shadow" height="87" width="87" :src="project.logo" alt="Hackathon logo" />
                                  <img v-else class="card-project-logo m-auto rounded shadow" height="87" width="87" :src="project.bounty.avatar_url" alt="Bounty Logo" />
                                </div>
                                <div class="card-body">
                                <h5 class="card-title font-weight-bold text-left">[[ project.name ]]</h5>
                                <div class="my-2">
                                  <p class="text-left text-muted font-smaller-1">
                                    [[ project.summary | truncate(500) ]]
                                  </p>
                                  <div class="text-left">
                                    <a :href="project.work_url" target="_blank" class="btn btn-sm btn-gc-blue font-smaller-2 font-weight-semibold">View Project</a>

                                    <a :href="project.bounty.url" class="btn-sm btn-outline-gc-blue font-smaller-2 font-weight-semibold">View Bounty</a>
                                    <b-dropdown varitant="primary" toggle-class="btn-sm btn btn-gc-blue" split-class="btn-sm btn btn-gc-blue">
                                     <template v-slot:button-content>
                                       <i class='fas fa-comment-dots'></i>
                                     </template>
                                     <b-dropdown-item-button @click.prevent="openChat(profile.handle);" v-for="profile in project.profiles" aria-describedby="dropdown-header-label">
                                       @ [[ profile.handle ]]
                                     </b-dropdown-item-button>
                                    </b-dropdown>
                                  </div>
                                </div>

                                <div class="my-3 mb-2 text-left">
                                  <b class="font-weight-bold font-smaller-3">Team Members</b>
                                  <div class="mt-1">
                                      <a v-for="profile in project.profiles" :href=`/profile/${profile.handle}` class="">
                                        <b-img-lazy :src="profile.avatar_url" :alt=`"@${profile.handle}"` :title="profile.handle" width="30" height="30" class="rounded-circle"></b-img-lazy>
                                      </a>
                                  </div>
                                </div>

                                <div v-if="project.looking_members || project.message" class="my-3 looking-team">
                                  <h5 v-if="project.looking_members"  class="info-card-title uppercase">Looking for team members</h5>
                                  <p v-if="project.message" class="info-card-desc">
                                    [[ project.message ]]
                                  </p>
                                </div>

                                <div class="font-smaller-2 mt-4">
                                  <b class="font-weight-bold">Sponsored by</b>
                                  <img class="" width="20" :src="project.bounty.avatar_url" :alt="project.bounty.org_name" />
                                  <a :href=`/profile/${project.bounty.org_name}`>[[ project.bounty.org_name ]]</a>
                                </div>
                              </div>
                              </div>
                          </div>
                        </div>
                        <loading-screen v-if="isLoading"></loading-screen>
                      </div>
                      </div>
                    </div>
                </div>
                  </project-directory>
                </b-tab>
              <b-tab :disabled="!is_registered"  class="col-12" title-item-class="navigation">
                <template v-slot:title>
                  <div class="mt-4">
                    {% trans "Chat" %}
                  </div>
                </template>
                <template>
                  <div class="ml-4">
                    <div class="chatWrapper col-12">
                      <iframe frameborder="0" :src="`${chatURL}/hackathons/channels/${hackathonObj.chat_channel_id}`" allowfullscreen></iframe>
                    </div>
                  </div>
                </template>
              </b-tab>
              <b-tab class="col-12" :disabled="!is_registered" title-item-class="navigation"lazy>
                  <template v-slot:title>
                    <div class="mt-4">
                      {% trans "Participants" %}
                      <span class="nav-badge d-none d-sm-inline">({{hacker_count}})</span>
                    </div>
                  </template>
                  <user-directory :disabled="!is_registered"  inline-template>
                    <div class="ml-4">
                      <div class="sidebar-container flex-column flex-lg-row">
                        <transition name="fade">
                          <nav v-show="showFilters" class="sidebar flex-fill pr-4" role="navigation">
                            <div class="pb-4 border-bottom form-group">
                              <div class="d-flex flex-grow-1" id="search">
                                <form class="form-inline my-2 flex-fill justify-content-center">
                                  <div class="input-group w-100">
                                    <input class="form-control form-control-lg" v-model="searchTerm" type="search" placeholder="Search" aria-label="Search">
                                    <div class="input-group-append">
                                      <button type="submit" class="btn input-group-text btn-search" @click.prevent="searchUsers()"> <i class="fas fa-search"></i></button>
                                    </div>
                                  </div>
                                </form>
                              </div>
                            </div>
                            <div class="pb-4 border-bottom form-group">
                              <label for="persona" class="font-weight-bold">Persona</label>
                              <div class="form__select2">
                                <select2 v-model="params.persona" data-minimum-results-for-search="Infinity" class="form-control">
                                  <option value="" selected="true">All</option>
                                  <option value="funder">Funder</option>
                                  <option value="coder">Coder</option>
                                </select2>
                              </div>
                            </div>
                            <div class="pb-4 border-bottom form-group">
                              <label for="leaderboard_rank" class="font-weight-bold">Leaderboard Rank</label>
                              <div class="form__select2">
                                <select2 v-model.trim="params.leaderboard_rank" data-tags="true" class="form-control">
                                  <option value="" selected="true">All</option>
                                  <option value="1,5">1,5</option>
                                  <option value="5,10">5,10</option>
                                  <option value="10,15">10,15</option>
                                  <option value="15,20">15,20</option>
                                  <option value="20,25">20,25</option>
                                </select2>
                              </div>
                            </div>
                            <div  v-if="persona != 'tribe'" class="g-multiselect pb-4 border-bottom form-group">
                              <label for="skills" class="font-weight-bold">Skills</label>
                              <div class="form__select2">
                                <select2 :options="skills" v-model="params.skills" data-placeholder="e.g. HTML, CSS" data-tags="true" multiple class="form-control">
                                  <option disabled value="0">Select one</option>
                                </select2>
                              </div>
                            </div>
                            <div v-if="persona != 'tribe'" class="pb-4 border-bottom form-group">
                              <label for="bounty-completed" class="font-weight-bold">Bounties Completed</label>
                              <div class="form__select2">
                                <select2 v-model.trim="params.bounties_completed" data-tags="true" class="form-control">
                                  <option value="" selected="true">All</option>
                                  <option value="0,5">0,5</option>
                                  <option value="5,10">5,10</option>
                                  <option value="10,15">10,15</option>
                                  <option value="15,20">15,20</option>
                                </select2>
                              </div>
                            </div>
                            <div v-if="persona != 'tribe'" class="pb-2 border-bottom form-group">
                              <div class="w-100 p-2">
                                <fieldset class="">
                                  <label for="" class="font-weight-bold">Star Rating</label>
                                  <div class="rating font-smaller-4">
                                    <input type="radio" id="rating-5" name="rating" value="5" v-model="params.rating" />
                                    <label class ="rating-star full" for="rating-5" data-toggle="tooltip" title="It was great - 5 stars"></label>
                                    <input type="radio" id="rating-4" name="rating" value="4" v-model="params.rating" />
                                    <label class ="rating-star full" for="rating-4" data-toggle="tooltip" title="It was good - 4 stars"></label>
                                    <input type="radio" id="rating-3" name="rating" value="3" v-model="params.rating" />
                                    <label class ="rating-star full" for="rating-3" data-toggle="tooltip" title="It was okay - 3 stars"></label>
                                    <input type="radio" id="rating-2" name="rating" value="2" v-model="params.rating" />
                                    <label class ="rating-star full" for="rating-2" data-toggle="tooltip" title="It was bad - 2 stars"></label>
                                    <input type="radio" id="rating-1" name="rating" value="1" v-model="params.rating" />
                                    <label class ="rating-star full" for="rating-1" data-toggle="tooltip" title="It was terrible - 1 star"></label>
                                  </div>
                                </fieldset>
                              </div>
                            </div>
                            <div v-if="persona != 'tribe'" class="g-multiselect pb-4 border-bottom form-group">
                              <label for="organisations" class="font-weight-bold">Tribe</label>
                              <div class="font-smaller">
                                <input v-model.lazy="params.organisation" data-placeholder="e.g. Gitcoin" data-tags="true" class="form-control">
                              </div>
                            </div>
                            <button class="btn blue font-caption px-0 btn-block font-weight-semibold" @click="params = {};">Reset Filters</button>
                            {% if is_staff %}
                              <p class="font-body mx-2 mb-2 mt-4 mx-lg-0 mt-lg-2">
                                <span class="font-weight-bold">[[ numUsers ]]</span> users found
                              </p>
                              <button v-if="persona != 'tribe'" v-show="numUsers > 0"  data-toggle="modal" data-target="#inviteAll" :disabled="!(params && (Object.keys(params).length > 1))" class="font-body btn btn-gc-blue ml-2" id="bulk-invite-modal">
                                Invite all to bounty
                              </button>
                            {% endif %}
                          </nav>
                        </transition>
                        <div class="container pt-4" @scroll.passive="onScroll($event)">
                          <button v-if="!hideFilterButton" class="blue btn font-smaller-1 font-weight-bold" @click="showFilters = !showFilters">[[ showFilters ? 'Hide' : 'Show' ]] filters <i class="fas fa-filter"></i></button>
                          <div class="py-5 mt-4">
                            <div v-if="noResults" class="text-center">
                              <img src="{% static 'v2/images/shrug_bot.png' %}" alt="nothing found" width="316" height="221">
                              <p class="mt-4 font-weight-bold mb-0">No users found</p>
                              <button class="btn blue" @click="params = {}; searchUsers()">Reset Filters</button>
                            </div>
                            <div class="grid-4">
                              <div v-for="user in users" class="card card-user shadow-sm border-0" :key="user.id">
                                <div class="d-flex flex-column py-1 bg-lightblue">
                                  <button class="btn position-absolute align-self-end" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><i class="fas fa-ellipsis-v"></i></button>
                                  <div class="dropdown-menu dropdown-menu-right font-caption bg-white">
                                    <a :href="`/funding/new?invite=${ user.id }`" target="_blank" class="dropdown-item p-2">
                                      <i class="fab fa-ethereum mr-2"></i>
                                      Fund Bounty
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <a :href="`/profile/${ user.handle }`" class="dropdown-item p-2" target="_blank">
                                      <i class="fas fa-user mr-2"></i>
                                      View profile
                                    </a>
                                  </div>
                                  <a :href="`/profile/${ user.handle }`" class="mx-auto">
                                    <img class="rounded-circle shadow-sm mt-n5 mb-3 bg-white" width="113" height="113" :src="`/dynamic/avatar/${ user.handle }`" alt="${user.handle} Avatar"/>
                                  </a>
                                  <h5 class="text-center card-user_name">
                                    [[ user.name || user.handle ]]
                                    <span v-if="user.verification">
                                      <img src="{% static 'v2/images/badge-verify.svg' %}" width="15" height="15" title="Verified user" alt="verify badget">
                                    </span>
                                  </h5>
                                  <a :href="`/profile/${ user.handle }`" class="text-center d-block">
                                    @[[ user.handle ]]
                                  </a>
                                  <div v-if="!user.is_org" class="card-user_stars text-center my-2">
                                    <i class="far fa-star" :class="star <= user.avg_rating.overall.toFixed() ? 'fas' : 'far'" v-for="star in user.avg_rating.overall.toFixed(), 5"></i>
                                    ([[ user.avg_rating.total_rating ]] ratings)
                                  </div>
                                  <small class="text-center pb-1" v-if="user.previously_worked">
                                    <i class="far fa-handshake mr-1"></i>Worked with you
                                  </small>
                                </div>
                                <div class="card-body d-flex flex-column justify-content-between">
                                  <!-- TRIBE -->
                                  <template v-if="user.is_org">
                                    <div v-html="user.tribe_description" class="overflow-hidden mb-2 text-black-70" style="max-height: 4.5rem;">
                                    </div>
                                    <div class="text-left">
                                      <span v-if="user.rank_org > 0"><b>#[[ user.rank_org ]]</b> Tribe</span>
                                    </div>
                                    <div class="text-left">
                                      <p class="mb-0">
                                        <i class="fas fa-user font-smaller-4 mr-1"></i>
                                        <b>[[ user.follower_count ]]</b> followers
                                      </p>
                                      <p class="mb-0">
                                        <i class="fas fa-trophy font-smaller-4 mr-1"></i>
                                        <b>[[ user.count_bounties_on_repo ]]</b> Bounties Funded
                                        (<b>[[ user.sum_eth_on_repos ]] ETH</b>)
                                      </p>
                                    </div>
                                  </template>

                                  <!-- User : Funder / Contributor-->
                                  <template v-else>
                                    <div v-if="user.keywords" class="text-center">
                                      <template v-for="keyword in user.keywords">
                                        <span class="badge badge--bluelight">[[ keyword ]]</span>[[ ' ' ]]
                                      </template>
                                    </div>
                                    <div class="text-center my-1 font-smaller-1">
                                      <a :href="`https://github.com/${ user.handle }`" target="_blank" rel="noopener noreferrer" >
                                        <i class="fab fa-github"></i>
                                      </a>
                                      <a :href="`${ user.blog }`" target="_blank" rel="noopener noreferrer" v-if="user.blog">
                                        <i class="fas fa-home"></i>
                                      </a>
                                      <a :href="`https://www.linkedin.com/in/${ user.linkedin_url }`" v-if="user.linkedin_url">
                                        <i class="fab fa-linkedin-in"></i>
                                      </a>
                                      <a @click="chatWindow(user);" href="#" v-if="user.chat_id">
                                        <i class="fas fa-comment-dots"></i>
                                      </a>
                                    </div>
                                    <div class="text-center" id="job_status" v-if="user.show_job_status">
                                      <a v-if="user.resume && user.job_search_status !== 'N'" :href="`${media_url}${user.resume}`" download data-toggle="tooltip" title="Download resume">
                                        <i class="fa fa-briefcase mr-2" aria-hidden="true"></i> [[ user.job_status ]]
                                      </a>
                                    </div>
                                    <div class="text-left">
                                      <p class="mb-0">
                                        <i class="fas fa-user font-smaller-4 mr-1"></i>
                                        <b>[[ user.follower_count ]]</b> followers
                                      </p>
                                      <p v-if="!isFunder" class="mb-0">
                                        <b>[[ user.work_done ]]</b> bounties completed
                                      </p>
                                      <p class="mb-0">
                                        <span v-if="user.position_contributor > 0">
                                          <b>#[[ user.position_contributor ]]</b> contributor
                                        </span>
                                        <span v-if="user.position_funder > 0">
                                          <b>#[[ user.position_funder ]]</b> funder
                                        </span>
                                      </p>
                                    </div>
                                    <div class="text-center mt-2">
                                      <button v-if="funderBounties.length" data-toggle="modal" data-target="#userModal" class="btn btn-sm btn-outline-gc-blue font-caption font-weight-semibold button--full" @click="openBounties(user)">Invite to Bounty</button>
                                    </div>
                                  </template>

                                  <div class="text-center mt-2">
                                    <button v-if="user.is_following" @click="joinTribe(user, $event)"
                                      class="btn btn-sm btn-gc-pink font-caption font-weight-semibold button--full"
                                    >
                                      <i class="fas fa-user-minus mr-1"></i>
                                      Unfollow
                                    </button>
                                    <button v-else @click="joinTribe(user, $event)"
                                      class="btn btn-sm btn-gc-blue font-caption font-weight-semibold button--full"
                                    >
                                      <i class="fas fa-user-plus mr-1"></i>
                                      Follow
                                    </button>
                                  </div>

                                </div>
                              </div>
                            </div>
                            <loading-screen v-if="isLoading"></loading-screen>
                          </div>
                        </div>
                        <modal ref="user-modal" id="userModal">
                          <div slot="header" v-if="userSelected.handle">
                            <div class="d-flex flex-column align-items-center">
                              <h6 class="font-weight-bold mb-3">Invite User to Bounty</h6>
                              <img class="rounded-circle mx-auto mb-3" width="64" height="64" :src="`/dynamic/avatar/${ userSelected.handle }`" alt="Avatar"/>
                              <span>[[ userSelected.name ]]</span>
                              <a :href="`/profile/${ userSelected.handle }`" class="text-center d-block" target="_blank">
                                [[ userSelected.handle ]]
                              </a>
                            </div>
                          </div>
                          <div slot="body" v-if="userSelected.handle">
                            <div v-if="funderBounties.length">
                              <div class="my-2 text-center">
                                <b>Select a bounty</b> or <a :href="`/funding/new?invite=${ userSelected.id }`" target="_blank" class="font-weight-bold">create a new one</a>
                              </div>
                              <div class="bounties-box">
                                <div v-for="bounty in funderBounties" :key="bounty.id" @click="bountySelected = bounty" v-bind:class="{ 'btn-gc-blue': bountySelected && bounty.id === bountySelected.id, 'hidden': contributorInvite === userSelected.handle && currentBounty == bounty.id }"  class="bounty-select py-2 px-3 border-bottom d-flex align-items-center">
                                  <img :src="`/dynamic/avatar/${ bounty.funding_organisation || bounty.bounty_owner_github_username }`" class="rounded-circle flex-shrink-0" width="30" height="30" alt="Avatar">
                                  <p class="line-clamp font-smaller-2 my-0 mx-2">
                                    [[ bounty.title ]]
                                  </p>
                                  <div class="ml-auto flex-shrink-0">
                                    <span class="tag token">[[ bounty.value_true ]] [[ bounty.token_name ]]</span>
                                    <span class="tag usd">[[ bounty.value_in_usdt_now ]] USD</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div v-else class="text-center font-subheader mt-4">
                              <p class="font-weight-semibold">You've got NO open bounties</p>
                              <p class="font-body">
                                <a :href="`/funding/new?invite=${ userSelected.id }`" target="_blank">Create a bounty</a>
                                to invite [[ userSelected.handle ]]
                              </p>
                            </div>
                          </div>
                          <div slot="footer" class="d-flex align-items-center flex-fill">
                            <a v-if="bountySelected" :href="bountySelected.url" target="_blank" class="mr-5">view bounty</a>
                            <div class="ml-auto">
                              <button class="btn btn-outline-gc-blue" data-dismiss="modal">Cancel</button>
                              <button  v-if="funderBounties.length" class="btn btn-gc-blue" :disabled="!bountySelected" @click="sendInvite(bountySelected, userSelected.id)">Invite</button>
                            </div>
                          </div>
                        </modal>
                        {% if is_staff %}
                        <modal ref="user-modal" id="inviteAll" size="modal-lg" v-bind:issueDetails="issueDetails">
                            <div slot="header">
                              <div class="d-flex flex-column align-items-center">
                                <h6 class="font-weight-bold mb-3">Invite [[numUsers]] Users to the Bounty</h6>
                              </div>
                            </div>
                            <div slot="body">
                              <div class="form-group">
                                <label class="font-weight-semibold">Github Issue URL</label>
                                <input class="form-control" v-model="gitcoinIssueUrl" type="text" placeholder="https://github.com/gitcoinco/web/issues/5045" v-on:keyup="getIssueDetails(gitcoinIssueUrl)"/>
                              </div>
                              <span class="font-weight-semibold d-block mb-2" v-if="issueDetails">Description</span>
                              <div v-if="issueDetails" class="pre-scrollable p-3 bg-light rounded font-body" style="white-space: pre-line;">
                                <span class="text-black-60 text-uppercase d-block mt-3">ISSUE TITLE</span>
                                [[issueDetails.title]] <span class="badge">[[issueDetails.status]]</span>
                                <span class="text-black-60 text-uppercase d-block mt-3">ISSUE DESCRIPTION</span>
                                [[issueDetails.issue_description_text]]
                              </div>
                              <loading-screen v-else-if="gitcoinIssueUrl && !errorIssueDetails"></loading-screen>
                              <div class="alert-warning p-3" v-if="errorIssueDetails">
                                [[errorIssueDetails]]
                              </div>
                            </div>
                            <div slot="footer" class="d-flex align-items-center flex-fill">
                              <div class="ml-auto">
                                <button class="btn btn-outline-gc-blue" data-dismiss="modal">Cancel</button>
                                <button :disabled="gitcoinIssueUrl === '' && !issueDetails" class="btn btn-gc-blue" @click="sendInviteAll(issueDetails.pk)">Invite</button>
                              </div>
                            </div>
                          </modal>
                        {% endif %}
                      </div>
                    </div>
                  </user-directory>
                </b-tab>
              <template v-slot:tabs-end>
                <li role="presentation" class="nav-item navigation"><a href="{% url 'hackathon_onboard' hackathon.slug %}" class="text-reset text-decoration-none nav-link">
                  <div class="mt-4">
                    Guide
                  </div>
                </a></li>
              </template>
            </b-tabs>
          </div>
          <div class="col-12 col-md-3">
            <div id="sponsor_sidebar" class="font-body">
              <div class="sponsor-top"></div>
              <sponsor-tribes-widget v-if="hackathonSponsors.length > 0" inline-template>
                <div class="p-xl-0 p-4">
                  <div class="offset-1 subheading left-ribbon">
                    {% trans "Sponsor Tribes" %}
                  </div>
                  <ul class="list-unstyled">
                    <b-media v-for="sponsor in tribesData" tag="li"  class="bg-white rounded m-4" vertical-align="center">
                      <template v-slot:aside>
                        <b-avatar :src="sponsor.avatar_url" size="46" :alt="sponsor.org_name" class="ml-n3"></b-avatar>
                      </template>
                      <div class="py-3 pr-3">
                        <div class="d-flex justify-content-between">
                          <a class="mb-1 font-bigger-1 text-truncate w-50" :href="`/profile/${sponsor.org_name}`">[[ sponsor.display_name ]]</a>
                          <b-button variant="outline-primary" @click="followTribe(sponsor.org_name, $event)" class="btn-sm btn-outline-gc-blue">[[ sponsor.followed ? "unfollow" : "follow" ]]</b-button>
                        </div>

                        <div class="">
                          <ul class="list-unstyled" class="mb-0">
                            <li><i class="fas fa-fw fa-user"></i> [[ sponsor.follower_count ]] Followers</li>
                            <li><i class="fas fa-fw fa-trophy"></i> [[ sponsor.bounty_count ]] Bounties Funded</li>
                          </ul>
                        </div>
                      </div>
                    </b-media>
                  </ul>
                </div>
              </sponsor-tribes-widget>
            </div>
          </div>
        </div>
      </div>
    <div class="row bottom_notification font-caption">
      {{footer_msg|safe}}
    </div>

    <div id="onboard-footer" class="row hidden font-body">
      <div class="col-12">
        <p>{% trans "Want to Fund an issue ?" %}
          <a target="_blank" rel="noopener noreferrer" href="{% url "new_funding_short" %}">{% trans "Get Started!" %}</a>
        </p>
      </div>
    </div>

    {% include 'shared/result.html' %}
    {% include 'shared/featured_bounty_cards.html' %}
    {% include 'shared/analytics.html' %}
    {% include 'shared/footer_scripts.html' with vue=True %}
    {% include 'shared/footer.html' %}
    <script type="text/x-template" id="select2-template">
      <select>
        <slot></slot>
      </select>
    </script>
    <script src='{% static "v2/js/vue-components.js" %}'></script>
    {{orgs|json_script:"sponsor-list"}}
    {{hackathon_obj|json_script:"hackathon-object"}}
    <script>
      $('body').bootstrapTooltip({
        selector: '[data-toggle="tooltip"]'
      });
      const csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
      document.keywords = {{ keywords | safe }};
      document.is_registered = {{ is_registered | safe }};

      window.localStorage['tab'] = 'hackathon:{{hackathon.id | safe}}';
      document.hackathon = "{{ hackathon.slug | safe }}";
      document.hackathon_id = "{{ hackathon.id | safe }}";
      document.hackathonSponsors = JSON.parse(document.getElementById('sponsor-list').textContent);
      document.hackathonObj = JSON.parse(document.getElementById('hackathon-object').textContent);
      document.activePanel = parseInt({{panel | safe}});
      document.chatURL = "{{ chat_url | safe}}";
      if(location.hostname === 'gitcoin.co') $('#network-filter').hide();
    </script>
    <script src='{% static "v2/js/pages/dashboard-hackathon.js" %}'></script>
    {% include 'shared/activity_scripts.html' %}
    <script src='{% static "v2/js/status.js" %}'></script>
    <script src='{% static "v2/js/pages/townsquare.js" %}'></script>
    <script src='{% static "v2/js/pages/join_tribe.js" %}'></script>
    <script src='{% static "v2/js/users.js" %}'></script>
  </body>
</html>
